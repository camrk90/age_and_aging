hip_flexion %>%
filter(hip_extension_deg > 50) %>%
ggplot(aes(age, hip_extension_deg, group = individual_code)) +
geom_point(alpha = 0.3) +
geom_path(alpha = 0.5) +
theme(legend.position = "none")
hip_flexion_chron<- lmer(hip_flexion_deg ~ age + individual_sex + (1|individual_code),
data = hip_flexion)
hip_flexion_eq3<- lmer(hip_flexion_deg ~ age + between_age + individual_sex + (1|individual_code),
data = hip_flexion)
hip_flexion_within<- lmer(hip_flexion_deg ~ within_age + between_age + individual_sex + (1|individual_code),
data = hip_flexion)
summary(hip_flexion_chron)[["coefficients"]]
summary(hip_flexion_eq3)[["coefficients"]]
summary(hip_flexion_within)[["coefficients"]]
#Generate predicted responses
flexion_predicted_chron<- predict_response(hip_flexion_chron, "age")
re.flexion_predicted_chron<- predict_response(hip_flexion_chron,
terms = c("age", "individual_code"), type = "random")
flexion_predicted_eq3<- predict_response(hip_flexion_eq3, "age")
re.flexion_predicted_eq3<- predict_response(hip_flexion_eq3,
terms = c("age", "individual_code"), type = "random")
flexion_predicted_within<- predict_response(hip_flexion_within, "within_age")
re.flexion_predicted_within<- predict_response(hip_flexion_within,
terms = c("within_age", "individual_code"), type = "random")
ggplot() +
geom_point(data = hip_flexion,
inherit.aes=F,
aes(x = age,
y = hip_flexion_deg),
cex = 1,
shape = 1,
alpha = 0.8) +
geom_smooth(data = flexion_predicted_chron,
inherit.aes=F,
aes(x = x,
y = predicted),
color = 'steelblue2',
method="lm",
se = F) +
geom_smooth(data = flexion_predicted_eq3,
inherit.aes=F,
aes(x = x,
y = predicted),
color = 'purple',
method="lm",
se = F) +
geom_smooth(data = flexion_predicted_eq3,
inherit.aes=F,
aes(x = x,
y = predicted),
color = 'green4',
method="lm",
se = F,
linetype = "dashed") +
theme_classic(base_size = 18) +
theme(panel.background = element_rect(colour = "black", linewidth=1)) +
theme(legend.position = "none") +
theme(axis.text.x  = element_text(vjust=0.5, colour="black")) +
theme(axis.text.y  = element_text(vjust=0.5, colour="black")) +
theme(axis.title = element_text(vjust = -5)) +
theme(panel.background = element_rect(colour = "black", linewidth=3)) +
xlab("Age") +
ylab("Hip Flexion Deg.") +
scale_x_continuous(breaks = seq(5, 30, 5), limits = c(5, 30))
ggplot() +
geom_point(data = hip_flexion,
inherit.aes=F,
aes(x = age,
y = hip_flexion_deg),
cex = 1,
shape = 1,
alpha = 0.8) +
geom_smooth(data = flexion_predicted_chron,
inherit.aes=F,
aes(x = x,
y = predicted),
color = 'steelblue2',
method="lm",
se = F) +
geom_smooth(data = hip_flexion,
inherit.aes=F,
aes(x = age,
y = hip_flexion_deg),
color = 'purple',
method="lm",
se = F) +
theme_classic(base_size = 18) +
theme(panel.background = element_rect(colour = "black", linewidth=1)) +
theme(legend.position = "none") +
theme(axis.text.x  = element_text(vjust=0.5, colour="black")) +
theme(axis.text.y  = element_text(vjust=0.5, colour="black")) +
theme(axis.title = element_text(vjust = -5)) +
theme(panel.background = element_rect(colour = "black", linewidth=3)) +
xlab("Age") +
ylab("Hip Flexion Deg.") +
scale_x_continuous(breaks = seq(5, 30, 5), limits = c(5, 30))
eq3_ext +
xlab("Age") +
ylab("Hip Extension Deg.") +
scale_x_continuous(breaks = seq(5, 30, 5), limits = c(5, 30))
hip_flexion %>%
ggplot(aes(x=age, y=reorder(individual_code, min_age), colour=as.factor(individual_sex))) +
geom_path(linewidth = 1.5, alpha = 0.8) +
geom_point(colour="black", size = 0.5) +
scale_x_continuous(breaks = seq(0, 30, by=5)) +
scale_colour_manual(values = c("red3", "pink2"), name = "Sex") +
ylab("Individual") +
xlab("Age") +
theme_classic(base_size = 24) +
theme(axis.text.y=element_blank(),
axis.ticks.y=element_blank()) +
theme(legend.position = "none") +
theme(panel.background = element_rect(colour = "black", linewidth=3))
hip_flexion<- hip_flexion %>%
group_by(individual_code) %>%
mutate(min_age = min(age))
hip_flexion$age<- round(hip_flexion$age, 0)
hip_flexion %>%
ggplot(aes(x=age, y=reorder(individual_code, min_age), colour=as.factor(individual_sex))) +
geom_path(linewidth = 1.5, alpha = 0.8) +
geom_point(colour="black", size = 0.5) +
scale_x_continuous(breaks = seq(0, 30, by=5)) +
scale_colour_manual(values = c("red3", "pink2"), name = "Sex") +
ylab("Individual") +
xlab("Age") +
theme_classic(base_size = 24) +
theme(axis.text.y=element_blank(),
axis.ticks.y=element_blank()) +
theme(legend.position = "none") +
theme(panel.background = element_rect(colour = "black", linewidth=3))
hip_flexion %>%
ggplot(aes(x=age, fill=as.factor(individual_sex))) +
geom_bar(colour='black', position = 'dodge') +
scale_x_continuous(breaks = seq(0, 30, by=5)) +
scale_fill_manual(values = c("red3", "pink2"), name = "Sex") +
ylab("Count") +
xlab("Age") +
theme_classic(base_size = 24) +
theme(axis.text.y=element_blank(),
axis.ticks.y=element_blank()) +
theme(legend.position = "none") +
theme(panel.background = element_rect(colour = "black", linewidth=3))
hip_flexion %>%
ggplot(aes(x=age, y=reorder(individual_code, min_age), colour=as.factor(individual_sex))) +
geom_path(linewidth = 1.5, alpha = 0.8) +
geom_point(colour="black", size = 0.5) +
scale_x_continuous(breaks = seq(0, 30, by=5)) +
coord_cartesian(xlim = c(0, 30)) +
scale_colour_manual(values = c("red3", "pink2"), name = "Sex") +
ylab("Individual") +
xlab("Age") +
theme_classic(base_size = 24) +
theme(axis.text.y=element_blank(),
axis.ticks.y=element_blank()) +
theme(legend.position = "none") +
theme(panel.background = element_rect(colour = "black", linewidth=3))
hip_flexion %>%
ggplot(aes(x=age, fill=as.factor(individual_sex))) +
geom_bar(colour='black', position = 'dodge') +
scale_x_continuous(breaks = seq(0, 30, by=5)) +
coord_cartesian(xlim = c(0, 30)) +
scale_fill_manual(values = c("red3", "pink2"), name = "Sex") +
ylab("Count") +
xlab("Age") +
theme_classic(base_size = 24) +
theme(axis.text.y=element_blank(),
axis.ticks.y=element_blank()) +
theme(legend.position = "none") +
theme(panel.background = element_rect(colour = "black", linewidth=3))
hip_flexion %>%
ggplot(aes(x=age, fill=as.factor(individual_sex))) +
geom_bar(colour='black', position = 'dodge') +
scale_x_continuous(breaks = seq(0, 30, by=5)) +
scale_fill_manual(values = c("red3", "pink2"), name = "Sex") +
ylab("Count") +
xlab("Age") +
theme_classic(base_size = 24) +
theme(axis.text.y=element_blank(),
axis.ticks.y=element_blank()) +
theme(legend.position = "none") +
theme(panel.background = element_rect(colour = "black", linewidth=3))
hip_flexion %>%
ggplot(aes(x=n, fill=as.factor(individual_sex))) +
geom_bar(colour='black', position = 'dodge') +
scale_fill_manual(values = c("red3", "pink2"), name = "Sex") +
ylab("Count") +
xlab("N Samples") +
theme_classic(base_size = 24) +
theme(axis.text.y=element_blank(),
axis.ticks.y=element_blank()) +
theme(legend.position = "none") +
theme(panel.background = element_rect(colour = "black", linewidth=3))
View(hip_flexion)
ext_range<- hip_flexion %>%
group_by(individual_code) %>%
summarize(min = min(hip_extension_deg),
max = max(hip_extension_deg))
ext_range<- ext_range %>%
mutate(diff = min - max)
hip_ext<- hip_flexion %>%
filter(hip_extension_deg > 100)
hip_extension_chron<- lmer(hip_extension_deg ~ age + individual_sex + (1|individual_code),
data = hip_ext)
hip_extension_within<- lmer(hip_extension_deg ~ within_age + between_age + individual_sex + (1|individual_code),
data = hip_ext)
hip_extension_eq3<- lmer(hip_extension_deg ~ age + between_age + individual_sex + (1|individual_code),
data = hip_ext)
summary(hip_extension_chron)[["coefficients"]]
summary(hip_extension_within)[["coefficients"]]
summary(hip_extension_eq3)[["coefficients"]]
hip_ext<- hip_flexion
hip_extension_chron<- lmer(hip_extension_deg ~ age + individual_sex + (1|individual_code),
data = hip_ext)
hip_extension_within<- lmer(hip_extension_deg ~ within_age + between_age + individual_sex + (1|individual_code),
data = hip_ext)
hip_extension_eq3<- lmer(hip_extension_deg ~ age + between_age + individual_sex + (1|individual_code),
data = hip_ext)
summary(hip_extension_chron)[["coefficients"]]
summary(hip_extension_within)[["coefficients"]]
summary(hip_extension_eq3)[["coefficients"]]
length(unique(hip_flexion$individual_code))
hip_flexion %>%
filter(hip_extension_deg > 100) %>%
ggplot(aes(age, hip_extension_deg, group = individual_code)) +
geom_point(alpha = 0.3) +
geom_path(alpha = 0.5) +
theme(legend.position = "none")
hip_flexion %>%
filter(hip_extension_deg > 100) %>%
ggplot(aes(age, hip_extension_deg, colour = individual_code)) +
geom_point(alpha = 0.3) +
geom_path(alpha = 0.5) +
theme(legend.position = "none")
confint(hip_extension_chron)
summary(hip_extension_chron)[["coefficients"]]
summary(hip_extension_within)[["coefficients"]]
confint(hip_extension_within)
hip_ext<- hip_flexion %>%
filter(hip_extension_deg > 100)
hip_extension_chron<- lmer(hip_extension_deg ~ age + individual_sex + (1|individual_code),
data = hip_ext)
hip_extension_within<- lmer(hip_extension_deg ~ within_age + between_age + individual_sex + (1|individual_code),
data = hip_ext)
hip_extension_eq3<- lmer(hip_extension_deg ~ age + between_age + individual_sex + (1|individual_code),
data = hip_ext)
summary(hip_extension_chron)[["coefficients"]]
confint(hip_extension_chron)
summary(hip_extension_within)[["coefficients"]]
confint(hip_extension_within)
summary(hip_extension_eq3)[["coefficients"]]
confint(hip_extension_eq3)
hip_int_rotation_within<- lmer(hip_internal_rotation_deg ~ within_age + between_age + individual_sex + (1|individual_code),
data = hip_flexion)
hip_int_rotation_eq3<- lmer(hip_internal_rotation_deg ~ age + between_age + individual_sex + (1|individual_code),
data = hip_flexion)
hip_int_rotation_chron<- lmer(hip_internal_rotation_deg ~ age + individual_sex + (1|individual_code),
data = hip_flexion)
summary(hip_int_rotation_within)[["coefficients"]]
confint(hip_int_rotation_within)
summary(hip_int_rotation_eq3)[["coefficients"]]
confint(hip_int_rotation_eq3)
summary(hip_int_rotation_chron)[["coefficients"]]
confint(hip_int_rotation_chron)
summary(hip_int_rotation_chron)[["coefficients"]]
confint(hip_int_rotation_chron)
summary(hip_int_rotation_within)[["coefficients"]]
confint(hip_int_rotation_within)
summary(hip_int_rotation_chron)[["coefficients"]]
confint(hip_int_rotation_chron)
summary(hip_int_rotation_within)[["coefficients"]]
confint(hip_int_rotation_within)
summary(hip_int_rotation_eq3)[["coefficients"]]
confint(hip_int_rotation_eq3)
int_coefs<- as.data.frame(rbind(summary(hip_int_rotation_chron)[["coefficients"]], summary(hip_int_rotation_within)[["coefficients"]],
summary(hip_int_rotation_eq3)[["coefficients"]]))
View(int_coefs)
int_coefs<- int_coefs[c("age", "within_age", "between_age", "age.1", "between_age.1"),]
View(int_coefs)
library(tidyverse)
library(ggplot2)
library(ggeffects)
library(lme4)
#library(lmerTest)
#Define functions---------------------------------------------------------------
plot_slopes<- function(fixed, re, metadata, predictor, response){
ggplot() +
geom_ribbon(data = fixed,
inherit.aes = F,
aes(x = x,
y = predicted,
ymin = conf.low,
ymax = conf.high),
fill = "grey90")  +
geom_line(data = re,
aes(x = x,
y = predicted,
colour = group),
alpha = .2,
linewidth = .5) +
geom_smooth(data = fixed,
inherit.aes=F,
aes(x = x,
y = predicted),
color = 'black',
alpha = .35,
method="lm",
se = F) +
geom_point(data = metadata,
inherit.aes=F,
aes(x = {{predictor}},
y = {{response}}),
cex = 1,
shape = 1,
alpha = 0.4) +
theme_classic() +
theme(panel.background = element_rect(colour = "black", linewidth=1)) +
theme(legend.position = "none") +
theme(axis.text.x  = element_text(vjust=0.5, size=7, colour="black")) +
theme(axis.text.y  = element_text(vjust=0.5, size=7, colour="black")) +
theme(axis.title = element_text(size=7, vjust = -5))
}
#Import data--------------------------------------------------------------------
hip_flexion<- read_csv("/scratch/ckelsey4/Cayo_meth/hip_flexion.csv", col_names = T)
View(hip_flexion)
#Import data--------------------------------------------------------------------
hip_flexion<- read_csv("/scratch/ckelsey4/Cayo_meth/hip_flexion.csv", col_names = T)
View(hip_flexion)
#Import data--------------------------------------------------------------------
hip_flexion<- read_csv("/scratch/ckelsey4/Cayo_meth/hip_flexion.csv", col_names = T)
View(hip_flexion)
#Import data--------------------------------------------------------------------
hip_flexion<- read_csv("/scratch/ckelsey4/Cayo_meth/hip_flexion.csv", col_names = T)
View(hip_flexion)
hip_flexion<- hip_flexion %>%
group_by(individual_code) %>%
filter(age > 0) %>%
mutate(n = n()) %>%
filter(n > 1) %>%
mutate(between_age = mean(age),
within_age = age - between_age) %>%
relocate(within_age, .after = age) %>%
relocate(between_age, .after = within_age)
fem_abduction_within<- lmer(femoral_abduction_deg ~ within_age + between_age + individual_sex + (1|individual_code),
data = hip_flexion)
fem_abduction_eq3<- lmer(femoral_abduction_deg ~ age + between_age + individual_sex + (1|individual_code),
data = hip_flexion)
fem_abduction_chron<- lmer(femoral_abduction_deg ~ age + individual_sex + (1|individual_code),
data = hip_flexion)
summary(fem_abduction_chron)[["coefficients"]]
summary(fem_abduction_within)[["coefficients"]]
summary(fem_abduction_eq3)[["coefficients"]]
abduc_coefs<- as.data.frame(rbind(summary(fem_abduction_chron)[["coefficients"]], summary(fem_abduction_within)[["coefficients"]],
summary(fem_abduction_eq3)[["coefficients"]]))
abduc_coefs<- int_coefs[c("age", "within_age", "between_age", "age.1", "between_age.1"),]
fm.dat.chron<- predict_response(fem_abduction_chron, "age")
re.dat.chron<- predict_response(fem_abduction_chron, terms = c("age", "individual_code"), type = "random")
fm.dat.within<- predict_response(fem_abduction_within, "within_age")
re.dat.within<- predict_response(fem_abduction_within, terms = c("within_age", "individual_code"), type = "random")
fm.dat <- predict_response(fem_abduction_eq3, "age")
fm.dat_btwn <- predict_response(fem_abduction_eq3, "between_age")
re.dat<- predict_response(fem_abduction_eq3, terms = c("age", "individual_code"), type = "random")
ggplot() +
geom_point(data = hip_flexion,
inherit.aes=F,
aes(x = age,
y = hip_flexion_deg),
cex = 1,
shape = 1,
alpha = 0.8) +
geom_smooth(data = flexion_predicted_chron,
inherit.aes=F,
aes(x = x,
y = predicted),
color = 'steelblue2',
method="lm",
se = F) +
geom_smooth(data = flexion_predicted_eq3,
inherit.aes=F,
aes(x = x,
y = predicted),
color = 'purple',
method="lm",
se = F) +
geom_smooth(data = flexion_predicted_eq3,
inherit.aes=F,
aes(x = x,
y = predicted),
color = 'green4',
method="lm",
se = F,
linetype = "dashed") +
theme_classic(base_size = 18) +
theme(panel.background = element_rect(colour = "black", linewidth=1)) +
theme(legend.position = "none") +
theme(axis.text.x  = element_text(vjust=0.5, colour="black")) +
theme(axis.text.y  = element_text(vjust=0.5, colour="black")) +
theme(axis.title = element_text(vjust = -5)) +
theme(panel.background = element_rect(colour = "black", linewidth=3)) +
xlab("Age") +
ylab("Hip Flexion Deg.") +
scale_x_continuous(breaks = seq(5, 30, 5), limits = c(5, 30))
ggplot() +
geom_point(data = hip_flexion,
inherit.aes=F,
aes(x = age,
y = femoral_abduction_deg),
cex = 1,
shape = 1,
alpha = 0.8) +
geom_smooth(data = fm.dat.chron,
inherit.aes=F,
aes(x = x,
y = predicted),
color = 'steelblue2',
method="lm",
se = F) +
geom_smooth(data = fm.dat,
inherit.aes=F,
aes(x = x,
y = predicted),
color = 'purple',
method="lm",
se = F) +
geom_smooth(data = fm.dat,
inherit.aes=F,
aes(x = x,
y = predicted),
color = 'green4',
method="lm",
se = F,
linetype = "dashed") +
theme_classic(base_size = 18) +
theme(panel.background = element_rect(colour = "black", linewidth=1)) +
theme(legend.position = "none") +
theme(axis.text.x  = element_text(vjust=0.5, colour="black")) +
theme(axis.text.y  = element_text(vjust=0.5, colour="black")) +
theme(axis.title = element_text(vjust = -5)) +
theme(panel.background = element_rect(colour = "black", linewidth=3)) +
xlab("Age") +
ylab("Femoral Abduction") +
scale_x_continuous(breaks = seq(5, 30, 5), limits = c(5, 30))
fem_adduction_within<- lmer(femoral_adduction_deg ~ within_age + between_age + individual_sex + (1|individual_code),
data = hip_flexion)
fem_adduction_eq3<- lmer(femoral_adduction_deg ~ age + between_age + individual_sex + (1|individual_code),
data = hip_flexion)
fem_adduction_chron<- lmer(femoral_adduction_deg ~ age + individual_sex + (1|individual_code),
data = hip_flexion)
summary(fem_adduction_chron)[["coefficients"]]
confint(fem_adduction_chron)
summary(fem_adduction_within)[["coefficients"]]
confint(fem_adduction_within)
summary(fem_adduction_eq3)[["coefficients"]]
confint(fem_adduction_eq3)
fm.dat.chron<- predict_response(fem_adduction_chron, "age")
re.dat.chron<- predict_response(fem_adduction_chron, terms = c("age", "individual_code"), type = "random")
fm.dat.within<- predict_response(fem_adduction_within, "within_age")
re.dat.within<- predict_response(fem_adduction_within, terms = c("within_age", "individual_code"), type = "random")
fm.dat <- predict_response(fem_adduction_eq3, "age")
fm.dat_btwn <- predict_response(fem_adduction_eq3, "between_age")
re.dat<- predict_response(fem_adduction_eq3, terms = c("age", "individual_code"), type = "random")
ggplot() +
geom_point(data = hip_flexion,
inherit.aes=F,
aes(x = age,
y = femoral_adduction_deg),
cex = 1,
shape = 1,
alpha = 0.8) +
geom_smooth(data = fm.dat.chron,
inherit.aes=F,
aes(x = x,
y = predicted),
color = 'steelblue2',
method="lm",
se = F) +
geom_smooth(data = fm.dat,
inherit.aes=F,
aes(x = x,
y = predicted),
color = 'purple',
method="lm",
se = F) +
geom_smooth(data = fm.dat,
inherit.aes=F,
aes(x = x,
y = predicted),
color = 'green4',
method="lm",
se = F,
linetype = "dashed") +
theme_classic(base_size = 18) +
theme(panel.background = element_rect(colour = "black", linewidth=1)) +
theme(legend.position = "none") +
theme(axis.text.x  = element_text(vjust=0.5, colour="black")) +
theme(axis.text.y  = element_text(vjust=0.5, colour="black")) +
theme(axis.title = element_text(vjust = -5)) +
theme(panel.background = element_rect(colour = "black", linewidth=3)) +
xlab("Age") +
ylab("Femoral adduction") +
scale_x_continuous(breaks = seq(5, 30, 5), limits = c(5, 30))
summary(fem_adduction_chron)[["coefficients"]]
summary(fem_adduction_within)[["coefficients"]]
summary(fem_adduction_eq3)[["coefficients"]]
body_weight_within<- lmer(body_weight_lb ~ within_age + between_age + individual_sex + (1|individual_code),
data = hip_flexion)
body_weight_eq3<- lmer(body_weight_lb ~ age + between_age + individual_sex + (1|individual_code),
data = hip_flexion)
body_weight_chron<- lmer(body_weight_lb ~ age + individual_sex + (1|individual_code),
data = hip_flexion)
summary(body_weight_chron)[["coefficients"]]
summary(body_weight_within)[["coefficients"]]
